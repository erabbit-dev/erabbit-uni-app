import{d as a,g as e,k as l,l as t,y as s,o as r,c as n,w as u,a as c,b as o,n as d,u as i,t as v,P as f,Q as p,B as m,G as _,j as h,f as g,i as b,e as k,I as y,R as S,T as Y,U as C,V as x,D}from"./index-5ec5936b.js";import{h as M}from"./http.232d223e.js";import{_ as w}from"./_plugin-vue_export-helper.1b428a4d.js";const H=(a,e="YYYY-MM-DD HH:mm:ss")=>{const l=String(a.getFullYear()),t=String(a.getMonth()+1).padStart(2,"0"),s=String(a.getDate()).padStart(2,"0"),r=String(a.getHours()).padStart(2,"0"),n=String(a.getMinutes()).padStart(2,"0"),u=String(a.getSeconds()).padStart(2,"0");return e.replace("YYYY",l).replace("MM",t).replace("DD",s).replace("HH",r).replace("mm",n).replace("ss",u)},T=w(a({__name:"profile",setup(a){const{safeAreaInsets:w}=e(),T=l({}),j=async()=>{const a=await M({method:"GET",url:"/member/profile"});T.value=a.result,P.profile.avatar=a.result.avatar,P.profile.nickname=a.result.nickname};t((()=>{j()}));const P=s(),V=()=>{f({count:1,success:a=>{const e=a.tempFilePaths;F(e[0])}})},F=a=>{p({url:"/member/profile/avatar",name:"file",filePath:a,success:a=>{if(200===a.statusCode){const e=JSON.parse(a.data).result.avatar;T.value.avatar=e,P.profile.avatar=e,m({icon:"success",title:"更新成功"})}else m({icon:"error",title:"出现错误"})}})},I=a=>{T.value.gender=a.detail.value},U=a=>{T.value.birthday=a.detail.value};let B=["","",""];const G=async()=>{const{nickname:a,gender:e,birthday:l}=T.value,t=await(s={nickname:a,gender:e,birthday:l,provinceCode:B[0],cityCode:B[1],countyCode:B[2]},M({method:"PUT",url:"/member/profile",data:s}));var s;P.profile.nickname=t.result.nickname,m({icon:"success",title:"保存成功"}),setTimeout((()=>{_()}),400)};return(a,e)=>{const l=h,t=g,s=b,f=k,p=y,m=S,_=Y,M=C,j=x,P=D;return r(),n(t,{class:"viewport"},{default:u((()=>{var a;return[c(t,{class:"navbar",style:d({paddingTop:(null==(a=i(w))?void 0:a.top)+"px"})},{default:u((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(t,{class:"title"},{default:u((()=>[o("个人信息")])),_:1})])),_:1},8,["style"]),c(t,{class:"avatar"},{default:u((()=>[c(t,{onClick:V,class:"avatar-content"},{default:u((()=>{var a;return[c(s,{class:"image",src:null==(a=T.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),c(f,{class:"text"},{default:u((()=>[o("点击修改头像")])),_:1})]})),_:1})])),_:1}),c(t,{class:"form"},{default:u((()=>[c(t,{class:"form-content"},{default:u((()=>[c(t,{class:"form-item"},{default:u((()=>[c(f,{class:"label"},{default:u((()=>[o("账号")])),_:1}),c(f,{class:"account placeholder"},{default:u((()=>{var a;return[o(v(null==(a=T.value)?void 0:a.account),1)]})),_:1})])),_:1}),c(t,{class:"form-item"},{default:u((()=>[c(f,{class:"label"},{default:u((()=>[o("昵称")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:T.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>T.value.nickname=a)},null,8,["modelValue"])])),_:1}),c(t,{class:"form-item"},{default:u((()=>[c(f,{class:"label"},{default:u((()=>[o("性别")])),_:1}),c(M,{onChange:I},{default:u((()=>[c(_,{class:"radio"},{default:u((()=>{var a;return[c(m,{value:"男",color:"#27ba9b",checked:"男"===(null==(a=T.value)?void 0:a.gender)},null,8,["checked"]),o(" 男 ")]})),_:1}),c(_,{class:"radio"},{default:u((()=>{var a;return[c(m,{value:"女",color:"#27ba9b",checked:"女"===(null==(a=T.value)?void 0:a.gender)},null,8,["checked"]),o(" 女 ")]})),_:1})])),_:1})])),_:1}),c(t,{class:"form-item"},{default:u((()=>{var a;return[c(f,{class:"label"},{default:u((()=>[o("生日")])),_:1}),c(j,{onChange:U,mode:"date",class:"picker",value:null==(a=T.value)?void 0:a.birthday,start:"1900-01-01",end:i(H)(new Date)},{default:u((()=>{var a;return[(null==(a=T.value)?void 0:a.birthday)?(r(),n(t,{key:0},{default:u((()=>{var a;return[o(v(null==(a=T.value)?void 0:a.birthday),1)]})),_:1})):(r(),n(t,{key:1,class:"placeholder"},{default:u((()=>[o("请选择日期")])),_:1}))]})),_:1},8,["value","end"])]})),_:1}),c(t,{class:"form-item"},{default:u((()=>{var a;return[c(f,{class:"label"},{default:u((()=>[o("职业")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写职业",value:null==(a=T.value)?void 0:a.profession},null,8,["value"])]})),_:1})])),_:1}),c(P,{onClick:G,class:"form-button"},{default:u((()=>[o("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-784a75ef"]]);export{T as default};
