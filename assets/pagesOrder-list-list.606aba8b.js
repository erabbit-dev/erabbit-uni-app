import{d as e,g as a,k as t,a7 as s,o as l,c as r,w as o,h as u,F as n,r as i,a as d,b as c,t as f,u as p,A as v,n as _,B as m,E as y,e as g,f as k,i as S,j as h,S as b,x as C,v as x}from"./index-5ec5936b.js";import{o as w,O as R,g as I}from"./pay.02c2e520.js";import{i as j,e as B,f as D}from"./order.12210c51.js";import{_ as A}from"./_plugin-vue_export-helper.1b428a4d.js";import"./http.232d223e.js";const F=A(e({__name:"OrderList",props:{orderState:null},setup(e){const C=e,{safeAreaInsets:x}=a(),A={page:1,pageSize:5,orderState:C.orderState},F=t([]),O=t(!1),H=async()=>{if(O.value)return;if(!0===J.value)return m({icon:"none",title:"没有更多数据~"});O.value=!0;const e=await j(A);O.value=!1,F.value.push(...e.result.items),A.page<e.result.pages?A.page++:J.value=!0};s((()=>{H()}));const J=t(!1),N=t(!1),P=async()=>{N.value=!0,A.page=1,F.value=[],J.value=!1,await H(),N.value=!1};return(e,a)=>{const t=g,s=k,C=S,j=h,A=b;return l(),r(A,{"enable-back-to-top":"","scroll-y":"",class:"orders","refresher-enabled":"","refresher-triggered":N.value,onRefresherrefresh:P,onScrolltolower:H},{default:o((()=>{var e;return[(l(!0),u(n,null,i(F.value,(e=>(l(),r(s,{class:"card",key:e.id},{default:o((()=>[d(s,{class:"status"},{default:o((()=>[d(t,{class:"date"},{default:o((()=>[c(f(e.createTime),1)])),_:2},1024),d(t,null,{default:o((()=>[c(f(p(w)[e.orderState].text),1)])),_:2},1024),e.orderState>=p(R).DaiPingJia?(l(),r(t,{key:0,class:"icon-delete",onClick:a=>{return t=e.id,void y({content:"你确定要删除该订单？",confirmColor:"#27BA9B",success:async e=>{if(e.confirm){await D({ids:[t]});const e=F.value.findIndex((e=>e.id===t));F.value.splice(e,1)}}});var t}},null,8,["onClick"])):v("",!0)])),_:2},1024),(l(!0),u(n,null,i(e.skus,(a=>(l(),r(j,{key:a.id,class:"goods",url:`/pagesOrder/detail/detail?id=${e.id}`,"hover-class":"none"},{default:o((()=>[d(s,{class:"cover"},{default:o((()=>[d(C,{class:"image",mode:"aspectFit",src:a.image},null,8,["src"])])),_:2},1024),d(s,{class:"meta"},{default:o((()=>[d(s,{class:"name ellipsis"},{default:o((()=>[c(f(a.name),1)])),_:2},1024),d(s,{class:"type"},{default:o((()=>[c(f(a.attrsText),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128)),d(s,{class:"payment"},{default:o((()=>[d(t,{class:"quantity"},{default:o((()=>[c("共"+f(e.totalNum)+"件商品",1)])),_:2},1024),d(t,null,{default:o((()=>[c("实付")])),_:1}),d(t,{class:"amount"},{default:o((()=>[d(t,{class:"symbol"},{default:o((()=>[c("¥")])),_:1}),c(f(e.payMoney),1)])),_:2},1024)])),_:2},1024),d(s,{class:"action"},{default:o((()=>[e.orderState===p(R).DaiFuKuan?(l(),r(s,{key:0,class:"button primary",onClick:a=>(async e=>{await I({orderId:e}),m({title:"支付成功"}),F.value.find((a=>a.id===e)).orderState=R.DaiFaHuo})(e.id)},{default:o((()=>[c("去支付")])),_:2},1032,["onClick"])):(l(),u(n,{key:1},[d(j,{class:"button secondary",url:`/pagesOrder/create/create?orderId=${e.id}`,"hover-class":"none"},{default:o((()=>[c(" 再次购买 ")])),_:2},1032,["url"]),e.orderState===p(R).DaiShouHuo?(l(),r(s,{key:0,class:"button primary",onClick:a=>{return t=e.id,void y({content:"为保障您的权益，请收到货并确认无误后，再确认收货",confirmColor:"#27BA9B",success:async e=>{e.confirm&&(await B(t),m({icon:"success",title:"确认收货成功"}),F.value.find((e=>e.id===t)).orderState=R.DaiPingJia)}});var t}},{default:o((()=>[c(" 确认收货 ")])),_:2},1032,["onClick"])):v("",!0)],64))])),_:2},1024)])),_:2},1024)))),128)),d(s,{class:"loading-text",style:_({paddingBottom:(null==(e=p(x))?void 0:e.bottom)+"px"})},{default:o((()=>[c(f(J.value?"没有更多数据~":"正在加载..."),1)])),_:1},8,["style"])]})),_:1},8,["refresher-triggered"])}}}),[["__scopeId","data-v-57ac1114"]]),O=A(e({__name:"list",props:{type:null},setup(e){const a=e,s=t([{orderState:0,title:"全部",isRender:!1},{orderState:1,title:"待付款",isRender:!1},{orderState:2,title:"待发货",isRender:!1},{orderState:3,title:"待收货",isRender:!1},{orderState:4,title:"待评价",isRender:!1}]),p=t(s.value.findIndex((e=>e.orderState===Number(a.type))));return s.value[p.value].isRender=!0,(e,a)=>{const t=g,m=k,y=x,S=C;return l(),r(m,{class:"viewport"},{default:o((()=>[d(m,{class:"tabs"},{default:o((()=>[(l(!0),u(n,null,i(s.value,((e,a)=>(l(),r(t,{class:"item",key:e.title,onClick:()=>{p.value=a,e.isRender=!0}},{default:o((()=>[c(f(e.title),1)])),_:2},1032,["onClick"])))),128)),d(m,{class:"cursor",style:_({left:20*p.value+"%"})},null,8,["style"])])),_:1}),d(S,{class:"swiper",current:p.value,onChange:a[0]||(a[0]=e=>p.value=e.detail.current)},{default:o((()=>[(l(!0),u(n,null,i(s.value,(e=>(l(),r(y,{key:e.title},{default:o((()=>[e.isRender?(l(),r(F,{key:0,"order-state":e.orderState},null,8,["order-state"])):v("",!0)])),_:2},1024)))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-840ae08c"]]);export{O as default};
